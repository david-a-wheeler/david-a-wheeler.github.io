<HTML
><HEAD
><TITLE
>Tools</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="Secure Programming for Linux and Unix HOWTO"
HREF="index.html"><LINK
REL="UP"
TITLE="Special Topics"
HREF="special.html"><LINK
REL="PREVIOUS"
TITLE="Using PAM"
HREF="use-pam.html"><LINK
REL="NEXT"
TITLE="Windows CE"
HREF="windows-ce.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Secure Programming for Linux and Unix HOWTO</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="use-pam.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 11. Special Topics</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="windows-ce.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="TOOLS"
></A
>11.7. Tools</H1
><P
>Some tools may help you detect security problems before
you field the result.
They can't find all such problems, of course, but they can help
catch problems that would overwise slip by.
Here are a few tools, emphasizing open source / free software tools.</P
><P
>One obvious type of tool is a program to examine the source code
to search for patterns of known potential security problems
(e.g., calls to library functions in ways are often the source
of security vulnerabilities).
These kinds of programs are called ``source code scanners''.
Here are a few such tools:
<P
></P
><UL
><LI
><P
>Flawfinder, which I've developed; it's available at
<A
HREF="http://www.dwheeler.com/flawfinder"
TARGET="_top"
>http://www.dwheeler.com/flawfinder</A
>.
This is also a program that scans C/C++ source code for common problems,
and is also licensed under the GPL.
Unlike RATS, flawfinder is implemented in Python.
The developers of RATS and Flawfinder have agreed to find a way to
work together to create a single ``best of breed'' open source program.</P
></LI
><LI
><P
>RATS (Rough Auditing Tool for Security)
from Secure Software Solutions is available at
<A
HREF="http://www.securesw.com/rats"
TARGET="_top"
>http://www.securesw.com/rats</A
>.
This program scans C/C++ source code for common problems, and
is licensed under the GPL.</P
></LI
><LI
><P
>ITS4 from Cigital (formerly Reliable Software Technologies, RST)
also statically checks C/C++ code.
It is available free for non-commercial use, including its source code
and with certain modification and redistribution rights.
Note that this isn't released as ``open source'' as defined by the
<A
HREF="http://www.opensource.org/osd.html"
TARGET="_top"
>Open
Source Definition</A
> (OSD) -
In particular, OSD point 6 forbids
``non-commercial use only'' clauses in open source licenses.
ITS4 is available at
<A
HREF="http://www.rstcorp.com/its4"
TARGET="_top"
>http://www.rstcorp.com/its4</A
>.</P
></LI
><LI
><P
>Splint (formerly named LCLint) is a tool for statically checking C programs.
With minimal effort, splint can be used as a better lint.
If additional effort is invested adding annotations to programs,
splint can perform stronger checking than can be done by any standard lint. 
For example, it can be used to statically detect likely buffer overflows.
The software is licensed under the GPL and is available at
<A
HREF="http://www.splint.org"
TARGET="_top"
>http://www.splint.org</A
>.</P
></LI
><LI
><P
>cqual is a type-based analysis tool for finding bugs in C programs. cqual 
extends the type system of C with extra user-defined type qualifiers, 
e.g., it can note that values are ``tainted'' or ``untainted''
(similar to Perl's taint checking). The 
programmer annotates their program in a few places, and cqual performs 
qualifier inference to check whether the annotations are correct. cqual 
presents the analysis results using Program Analysis Mode, an emacs-based
interface.
The current version of cqual can detect potential format-string 
vulnerabilities in C programs.
A previous incarnation of cqual, Carillon, 
has been used to find Y2K bugs in C programs.
The software is licensed under the GPL and is available from
<A
HREF="http://www.cs.berkeley.edu/Research/Aiken/cqual"
TARGET="_top"
>http://www.cs.berkeley.edu/Research/Aiken/cqual</A
>.</P
></LI
><LI
><P
>Smatch is a general-purpose static analysis tools for C/C++ programs.
It generates output describing statically-determined states in a program,
and has an API to let you define queries for potentially bad situations.
It was originally designed to analyze the Linux kernel.
More information is at
<A
HREF="http://smatch.sourceforge.net"
TARGET="_top"
>http://smatch.sourceforge.net</A
>.</P
></LI
><LI
><P
>Cyclone is a C-like language intended to remove C's security weaknesses.
In theory, you can always switch to a language that is ``more secure,''
but this doesn't always help (a language can help you avoid common mistakes
but it can't read your mind).
<A
HREF="http://www.securityfocus.com/guest/9094"
TARGET="_top"
>John Viega has
reviewed Cyclone</A
>, and in December 2001 he said:
``Cyclone is definitely a neat language.
It's a C dialect that doesn't feel like it's taking away any power,
yet adds strong safety guarantees, along with numerous features that
can be a real boon to programmers.
Unfortunately, Cyclone isn't yet ready for prime time.
Even with crippling limitations aside, it doesn't yet offer
enough advantages over Java (or even C with a good set of tools)
to make it worth the risk of using what is still a very young technology.
Perhaps in a few years, Cyclone will mature into a robust,
widely supported language that comes dangerously
close to C in terms of efficiency.
If that day comes, you'll certainly see me abandoning C for good.''
The Cyclone compiler has been released under the GPL and LGPL.
You can get more information from the
<A
HREF="http://www.research.att.com/projects/cyclone"
TARGET="_top"
>Cyclone web site</A
>.</P
></LI
></UL
></P
><P
>Some tools try to detect potential security flaws at run-time,
either to counter them or at least to warn the developer about them.
Much of Crispin Cowan's work, such as StackGuard, fits here.</P
><P
>There are several tools that try to detect various C/C++ memory-management
problems; these are really general-purpose software quality improvement
tools, and not specific to security, but memory management problems
can definitely cause security problems.
An especially capable tool is
<A
HREF="http://developer.kde.org/~sewardj"
TARGET="_top"
>Valgrind</A
>,
which detects various memory-management problems
(such as use of uninitialized memory, reading/writing memory after it's been
free'd, reading/writing off the end of malloc'ed blocks,
and memory leaks).
Another such tool is Electric Fence (efence) by Bruce Perens, which can
detect certain memory management errors.
<A
HREF="http://www.linkdata.se/sourcecode.html"
TARGET="_top"
>Memwatch</A
>
(public domain) and
<A
HREF="http://odin.ac.hmc.edu/~neldredge/yamd/"
TARGET="_top"
>YAMD</A
> (GPL)
can detect memory allocation problems for C and C++.
You can even use the built-in capabilities of the
GNU C library's malloc library, which has the
MALLOC_CHECK_ environment variable (see its manual page for more information).
There are many others.</P
><P
>Another approach is to create test patterns and run the program,
in attempt to find weaknesses in the program.
Here are a few such tools:
<P
></P
><UL
><LI
><P
>BFBTester, the Brute Force Binary Tester, is licensed under the GPL.
This program does quick security checks of binary programs.
BFBTester performs checks of single and multiple argument
command line overflows and environment variable overflows.
Version 2.0 and higher can also watch for tempfile creation activity
(to check for using unsafe tempfile names). 
At one time BFBTester didn't run on Linux (due to
a technical issue in Linux's POSIX threads implementation), but this
has been fixed as of version 2.0.1.
More information is available at
<A
HREF="http://bfbtester.sourceforge.net/"
TARGET="_top"
>http://bfbtester.sourceforge.net/</A
></P
></LI
><LI
><P
>The 
<A
HREF="http://fuzz.sourceforge.net"
TARGET="_top"
>fuzz</A
>
program
is a tool for testing other software.
It tests programs by bombarding the program being evaluated with random data.
This tool isn't really specific to security.</P
></LI
><LI
><P
><A
HREF="http://www.immunitysec.com/spike.html"
TARGET="_top"
>SPIKE</A
>
is a "fuzzer creation kit", i.e., it's a toolkit designed to
create "random" tests to find security problems.
The SPIKE toolkit is particularly designed for protocol analysis by
simulating network protocol clients, and SPIKE proXy is a tool built on
SPIKE to test web applications.
SPIKE includes a few pre-canned tests.
SPIKE is licensed under the GPL.</P
></LI
></UL
></P
><P
>There are a number of tools that try to give you insight into running
programs that can also be useful when trying to find security problems
in your code.
This includes symbolic debuggers (such as gdb) and trace programs
(such as strace and ltrace).
One interesting program to support analysis of running code is
<A
HREF="http://razor.bindview.com/tools/fenris"
TARGET="_top"
>Fenris</A
> (GPL license).
Its documentation describes Fenris as a
``multipurpose tracer, stateful analyzer and partial decompiler
intended to simplify bug tracking,
security audits, code, algorithm or protocol analysis -
providing a structural program trace, general information
about internal constructions, execution path,
memory operations, I/O, conditional expressions and much more.''
Fenris actually supplies a whole suite of tools, including
extensive forensics capabilities and
<A
HREF="http://lcamtuf.coredump.cx/fdesk.jpg"
TARGET="_top"
>a
nice debugging GUI for Linux</A
>.
A list of other promising open source tools that can be suitable
for debugging or code analysis is available at
<A
HREF="http://lcamtuf.coredump.cx/fenris/debug-tools.html"
TARGET="_top"
>http://lcamtuf.coredump.cx/fenris/debug-tools.html</A
>.
Another interesting program along these lines is Subterfugue,
which allows you to control what happens in every system call made
by a program.</P
><P
>If you're building a common kind of product where many standard
potential flaws exist (like an ftp server or firewall), you might
find standard security scanning tools useful.
One good one is
<A
HREF="http://www.nessus.org"
TARGET="_top"
>Nessus</A
>; there are many others.
These kinds of tools are very useful for doing regression testing,
but since they essentially use a list of past specific vulnerabilities
and common configuration errors,
they may not be very helpful in finding problems in new programs.</P
><P
>Often, you'll need to call on other tools to implement your secure
infrastructure.
The
<A
HREF="http://ospkibook.sourceforge.net"
TARGET="_top"
>Open-Source PKI Book</A
>
describes a number of open source programs for
implementing a public key infrastructure (PKI).</P
><P
>Of course, running a ``secure'' program on an insecure platform
configuration makes little sense.
You may want to examine hardening systems, which attempt to configure
or modify systems to be more resistant to attacks.
For Linux, one hardening system is
Bastille Linux, available at
<A
HREF="http://www.bastille-linux.org"
TARGET="_top"
>http://www.bastille-linux.org</A
>.</P
><P
>Another list of security tools is available at
<A
HREF="http://www.insecure.org/tools.html"
TARGET="_top"
>http://www.insecure.org/tools.html</A
>.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="use-pam.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="windows-ce.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Using PAM</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="special.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Windows CE</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>