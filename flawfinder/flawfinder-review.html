<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.0.2  (Linux)">
	<META NAME="AUTHOR" CONTENT="paolo">
	<META NAME="CREATED" CONTENT="20030909;11390000">
	<META NAME="CHANGEDBY" CONTENT="paolo">
	<META NAME="CHANGED" CONTENT="20030909;15080000">
	<STYLE>
	<!--
		@page { margin-left: 2cm; margin-right: 2cm; margin-top: 2.5cm; margin-bottom: 2cm }
		P { margin-bottom: 0.21cm; color: #000000; widows: 2; orphans: 2 }
		P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: it-IT }
		P.cjk { font-family: "Times New Roman", serif; font-size: 12pt }
		A:link { color: #0000ff }
	-->
	</STYLE>
</HEAD>
<BODY LANG="it-IT" TEXT="#000000" LINK="#0000ff">
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=5 STYLE="font-size: 20pt">Flawfinder,
un test di sicurezza per il codice C/C++</FONT></FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">Flawfinder
(</FONT></FONT><FONT COLOR="#0000ff"><U><A HREF="http://www.dwheeler.com/flawfinder"><FONT SIZE=2><FONT FACE="Arial, sans-serif">http://www.dwheeler.com/flawfinder</FONT></FONT></A></U></FONT><FONT SIZE=2><FONT FACE="Arial, sans-serif">)
&egrave; una creazione di David A. Wheeler, l’autore del “Secure
Programming for Linux and Unix HOWTO”. Si tratta di un programma
che esamina il codice sorgente (attualmente solo C/C++, anche se
l’Autore asserisce di aver progettato Flawfinder in modo che sia
facile scrivere dei moduli aggiuntivi per qualsiasi linguaggio) e
riferisce sulle possibili “falle” (flaws) nella sicurezza; il
programma &egrave; disponibile, in formato tarball o RPM per
l’installazione su Linux Red Hat, per le piattaforme GNU
Linux/UNIX. La versione scaricabile al momento in cui scriviamo &egrave;
la 1.22, e richiede Python 1.5 o superiore per l’esecuzione (a
detta dell’Autore, Python 1.3 e precedenti non funzioneranno allo
scopo). Il programma viene distribuito, a titolo gratuito, secondo i
termini della General Public License versione 2, ed &egrave;
corredato da un manuale utente in formato PDF, scaricabile a parte o
disponibile nel package di installazione. Sul sito del prodotto &egrave;
disponibile il risultato della scansione di un codice C di esempio.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><B>Installazione</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">Come
ricordato, il programma &egrave; disponibile in formato tarball
(l’usuale .tar.gz) o come RPM sorgente o installabile per le
piattaforme RPM-based come Linux Red Hat 7.1 e successivi. Diamo di
seguito l’usuale procedura di installazione nel caso in cui siano
stati scaricati i sorgenti in formato tarball.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Dopo
essersi portati nella directory di installazione, &egrave; necessario
digitare la sequenza di comandi:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="de-DE">
 gunzip  flawfinder-*.tar.gz</SPAN></FONT></FONT></P>
<P LANG="de-DE" STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
 tar xvf flawfinder-*.tar</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="de-DE">
 </SPAN>cd flawfinder-*</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
 su</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
 make install</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">che
creer&agrave; una cartella “flawfinder” con l’eseguibile. Gli
utenti Debian possono scaricare ed installare Flawfinder in maniera
immediata, usando apt-get, grazie al packaging creato da Adam Lazur,
con il semplice comando:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
 apt-get flawfinder</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Per
chi ha invece scaricato l’RPM, il comando per installarlo &egrave;
il seguente:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
 rpm -Uvh flawfinder-*.noarch.rpm</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Infine,
gli utenti NetBSD possono usare pkgsrc per installare Flawfinder,
grazie al packaging creato da Thomas Klausner.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><B><SPAN LANG="en-GB"><FONT SIZE=2><FONT FACE="Arial, sans-serif">Prestazioni
e modalit&agrave; di funzionamento</FONT></FONT></SPAN></B></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">Flawfinder
&egrave; scritto in Python, al fine di semplificarne la stesura e
l’estendibilit&agrave;, e questo lo rende meno ‘performante’ di
analoghi programmi scritti in C. I benchmark disponibili si
riferiscono alla versione 0.12 e parlano di 51055 linee di codice
analizzate in 39.7 secondi su un Pentium II 400 MHz, per una media di
1258 linee al secondo. A partire dalla versione 1.20, il programma &egrave;
in grado di produrre un report con la velocit&agrave; di esecuzione.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">Flawfinder
lavora utilizzando un database incorporato (il cosiddetto ‘ruleset’)
di funzioni C/C++ con problemi di sicurezza ben noti, come buffer
overflow (ad es. strcpy(), strcat(), gets(), sprintf() e la famiglia
di funzioni scanf()), problemi di formattazione delle stringhe
([v][f]printf(), [v]snprintf(), e syslog()), condizioni di race
(access(), chown(), chgrp(), chmod(), tmpfile(), tmpnam(), tempnam(),
ed mktemp()), funzioni che presentano problemi in merito all’uso
dei metacaratteri in una shell (la maggior parte delle funzioni della
famiglia exec(), system(), popen()), o meccanismi deboli di
generazione di numeri casuali (random()). L’output del programma &egrave;
costituito da una lista di ‘hits’ (potenziali falle nella
sicurezza), ordinate in base al rischio (di default, le falle pi&ugrave;
gravi vengono mostrate per prime). Il livello di rischio &egrave;
calcolato, non solo in base alla funzione, ma anche sulla scorta dei
valori dei parametri della funzione: ad esempio, le stringhe costanti
vengono di norma considerate, in vari contesti, meno pericolose di
quelle variabili. In alcuni casi, Flawfinder &egrave; in grado di
determinare quei costrutti che non costituiscono una minaccia per la
sicurezza, riducendo il rischio di falsi positivi. Inoltre,
Flawfinder correttamente ignora il testo contenuto all’interno di
commenti e stringhe, eccezion fatta per le direttive del programma
stesso. Il programma &egrave; inoltre ‘aware’ (ben informato)
circa gettext (una comune libreria per l’internazionalizzazione di
programmi), e tratter&agrave; le stringhe passate attraverso gettext
come stringhe costanti, riducendo anche in questo caso il numero di
falsi positivi. In questo modo, l’informazione e la
prioritizzazione ottenibili sono maggiori di quelle che avremmo
lanciando un semplice ‘grep’ sul codice sorgente. &Egrave; bene
ricordare, tuttavia, che nonostante la serie di ottimizzazioni, non
necessariamente ogni ‘hit’ rilevato costituisce una vulnerabilit&agrave;
di sicurezza, n&eacute; il programma &egrave; in grado di trovare
tutte le vulnerabilit&agrave;: questo perch&eacute; Flawfinder non ha
alcuna consapevolezza circa la semantica del codice, limitandosi a
fare, pi&ugrave; che altro, un pattern matching intelligente del
codice. Nonostante le sue limitazioni, riteniamo che il programma sia
un valido ausilio nel trovare e rimuovere le vulnerabilit&agrave; di
sicurezza nel codice.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm">
<BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><B><FONT SIZE=2><FONT FACE="Arial, sans-serif">Utilizzo
del programma</FONT></FONT></B></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>La
sinopsi del programma &egrave; la seguente:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Courier New, monospace"><B>flawfinder
[--hel</B>p][<B>--versio</B>n][<B>--allowlin</B>k][<B>--input</B>s]<B>[-minlevel=</B><I>X
</I>]<B>[-m </B><I>X
</I>][<B>--neverignor</B>e]<B>[-</B>n]<B>[--column</B>s][<B>--contex</B>t]<B>[-</B>c][<B>--dataonl</B>y][<B>--htm</B>l][<B>--immediat</B>e]<B>[-</B>i][<B>--singleline]
[-</B>S][<B>--omit-tim</B>e][<B>--quie</B>t][<B>--loadhitlist=</B><I>F
</I>][<B>--savehitlist=</B><I>F </I>][<B>--diffhitlist=</B><I>F </I>][<B>-</B>-]
<I>[nome del codice sorgente o della directory che lo contiene ]+</I></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">ove
il significato dei vari switch &egrave; riassunto in <B>Tabella 1</B>.
La documentazione riporta anche alcuni esempi d’uso, che abbiamo
riunito nella <B>Tabella 2</B>. In sostanza, per eseguire Flawfinder
&egrave; sufficiente passargli una lista di directory o file da
esaminare. Il suo utilizzo normale &egrave; in due passi: il
programma viene eseguito una prima volta su di un set di codice
sorgente onde esaminare gli item a pi&ugrave; alto rischio, ed una
seconda volta con lo switch –inputs per esaminare l’input del
codice, e verificare che vengano considerati solo valori in input
privi di rischi da utenti non fidati. Una volta che &egrave; stato
effettuato l’audit di un programma, &egrave; possibile marcare
quelle linee del codice sorgente che producono errori spuri (o falsi
positivi) in modo che Flawfinder non le segnali pi&ugrave;; all’uopo,
&egrave; necessario inserire prima o dopo del codiche che produce
l’errore un commento formattato secondo uno dei due formati:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>//Flawfinder:
ignore</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*Flawfinder:
ignore */</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0cm"><FONT SIZE=2><FONT FACE="Arial, sans-serif">Per
motivi di compatibilit&agrave;, &egrave; possibile sostituire
“Flawfinder:” con “ITS4:” o “RATS:” in tali commenti; ci&ograve;
viene effettuato allo scopo di garantire la compatibilit&agrave; con
analoghi programmi, per la cui storia si rimanda il lettore alla
pagina Web del prodotto citata in apertura. Si fa altres&igrave;
presente che la direttiva –neverignore vanifica il risultato di
tali commenti, mostrando di nuovo gli hit relativi alle linee di
codice cui si riferiscono. Per prevenire problemi di sicurezza, file
speciali (come i dispositivi e le named pipe) vengono sempre esclusi
dall’analisi, e di default i link simbolici vengono ignorati,
mentre la direttiva –allowlink fa s&igrave; che anch’essi vengano
esaminati (vedi<B> Tabella 1</B>). I messaggi relativi alle
vulnerabilit&agrave; riscontrate sono conformi a quelli descritti nel
gi&agrave; ricordato documento “Secure Programming for Linux and
Unix HOWTO”, disponibile all’URL
</FONT></FONT><FONT COLOR="#0000ff"><U><A HREF="http://www.dwheeler.com/secure-programs"><FONT SIZE=2><FONT FACE="Arial, sans-serif">http://www.dwheeler.com/secure-programs</FONT></FONT></A></U></FONT><FONT SIZE=2><FONT FACE="Arial, sans-serif">,
che dovrebbe essere tenuto a m&ograve; di riferimento.</FONT></FONT></P>
</BODY>
</HTML>